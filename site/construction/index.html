<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=11" />
    <title>Наводим красоту</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>

  <body>
    <section class="section section-stub">
      <div class="container">
        <div class="logo-row content-row">
          <img src="img/logo.svg" alt="beautyhack logo" />
        </div>

        <h1 class="title content-row">
          <strong>Наводим</strong> красоту на сайте. <br />Покажем через...
        </h1>

        <div class="counter-container content-row">
          <div id="counter" data-finish="01/01/2020" data-max="30">
            <div class="num"></div>
            <div class="svg-wrap">
              <svg width="220" height="220" viewBox="0 0 220 220" fill="none">
                <filter id="bgBlur">
                  <feGaussianBlur in="SourceGraphic" stdDeviation="1" />
                </filter>
                <circle
                  cx="110"
                  cy="110"
                  r="100"
                  fill="none"
                  stroke="rgba(235, 87, 87, 0.35)"
                  stroke-width="10"
                  filter="url(#bgBlur)"
                />
                <circle
                  class="progress__value"
                  cx="110"
                  cy="110"
                  r="100"
                  fill="none"
                  stroke="#EB5757"
                  stroke-width="6"
                  stroke-dashoffset="628"
                  stroke-dasharray="628"
                  stroke-linecap="round"
                  style="transform: rotate(-90deg); transform-origin: center center;"
                />
              </svg>
            </div>
          </div>
          <span class="counter-days text"></span>
        </div>

        <div class="content-foot content-row">
          <div class="foot-title">А пока мы тут</div>
          <a href="https://beautyhack.ru/" class="black-btn">Старый сайт</a>
        </div>
      </div>

      <svg
        width="529"
        height="19"
        viewBox="0 0 529 19"
        fill="none"
        class="grey-lines"
      >
        <path d="M1 0L19 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M11 0L29 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M21 0L39 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M31 0L49 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M41 0L59 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M51 0L69 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M61 0L79 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M71 0L89 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M81 0L99 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M91 0L109 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M101 0L119 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M111 0L129 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M121 0L139 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M131 0L149 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M141 0L159 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M151 0L169 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M161 0L179 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M171 0L189 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M181 0L199 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M191 0L209 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M201 0L219 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M211 0L229 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M221 0L239 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M231 0L249 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M241 0L259 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M251 0L269 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M261 0L279 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M271 0L289 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M281 0L299 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M291 0L309 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M301 0L319 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M311 0L329 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M321 0L339 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M331 0L349 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M341 0L359 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M351 0L369 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M361 0L379 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M371 0L389 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M381 0L399 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M391 0L409 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M401 0L419 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M411 0L429 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M421 0L439 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M431 0L449 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M441 0L459 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M451 0L469 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M461 0L479 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M471 0L489 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M481 0L499 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M491 0L509 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M501 0L519 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M511 0L529 18" stroke="#E7E7E7" stroke-width="2" />
        <path d="M521 0L539 18" stroke="#E7E7E7" stroke-width="2" />
      </svg>

      <svg
        width="491"
        height="19"
        viewBox="0 0 491 19"
        fill="none"
        class="red-lines"
      >
        <path d="M-18 1L2.98023e-07 19" stroke="#EB5757" stroke-width="2" />
        <path d="M-8 1L10 19" stroke="#EB5757" stroke-width="2" />
        <path d="M2 1L20 19" stroke="#EB5757" stroke-width="2" />
        <path d="M12 1L30 19" stroke="#EB5757" stroke-width="2" />
        <path d="M22 1L40 19" stroke="#EB5757" stroke-width="2" />
        <path d="M32 1L50 19" stroke="#EB5757" stroke-width="2" />
        <path d="M42 1L60 19" stroke="#EB5757" stroke-width="2" />
        <path d="M52 1L70 19" stroke="#EB5757" stroke-width="2" />
        <path d="M62 1L80 19" stroke="#EB5757" stroke-width="2" />
        <path d="M72 1L90 19" stroke="#EB5757" stroke-width="2" />
        <path d="M82 1L100 19" stroke="#EB5757" stroke-width="2" />
        <path d="M92 1L110 19" stroke="#EB5757" stroke-width="2" />
        <path d="M102 1L120 19" stroke="#EB5757" stroke-width="2" />
        <path d="M112 1L130 19" stroke="#EB5757" stroke-width="2" />
        <path d="M122 1L140 19" stroke="#EB5757" stroke-width="2" />
        <path d="M132 1L150 19" stroke="#EB5757" stroke-width="2" />
        <path d="M142 1L160 19" stroke="#EB5757" stroke-width="2" />
        <path d="M152 1L170 19" stroke="#EB5757" stroke-width="2" />
        <path d="M162 1L180 19" stroke="#EB5757" stroke-width="2" />
        <path d="M172 1L190 19" stroke="#EB5757" stroke-width="2" />
        <path d="M182 1L200 19" stroke="#EB5757" stroke-width="2" />
        <path d="M192 1L210 19" stroke="#EB5757" stroke-width="2" />
        <path d="M202 1L220 19" stroke="#EB5757" stroke-width="2" />
        <path d="M212 1L230 19" stroke="#EB5757" stroke-width="2" />
        <path d="M222 1L240 19" stroke="#EB5757" stroke-width="2" />
        <path d="M232 1L250 19" stroke="#EB5757" stroke-width="2" />
        <path d="M242 1L260 19" stroke="#EB5757" stroke-width="2" />
        <path d="M252 1L270 19" stroke="#EB5757" stroke-width="2" />
        <path d="M262 1L280 19" stroke="#EB5757" stroke-width="2" />
        <path d="M272 1L290 19" stroke="#EB5757" stroke-width="2" />
        <path d="M282 1L300 19" stroke="#EB5757" stroke-width="2" />
        <path d="M292 1L310 19" stroke="#EB5757" stroke-width="2" />
        <path d="M302 1L320 19" stroke="#EB5757" stroke-width="2" />
        <path d="M312 1L330 19" stroke="#EB5757" stroke-width="2" />
        <path d="M322 1L340 19" stroke="#EB5757" stroke-width="2" />
        <path d="M332 1L350 19" stroke="#EB5757" stroke-width="2" />
        <path d="M342 1L360 19" stroke="#EB5757" stroke-width="2" />
        <path d="M352 1L370 19" stroke="#EB5757" stroke-width="2" />
        <path d="M362 1L380 19" stroke="#EB5757" stroke-width="2" />
        <path d="M372 1L390 19" stroke="#EB5757" stroke-width="2" />
        <path d="M382 1L400 19" stroke="#EB5757" stroke-width="2" />
        <path d="M392 1L410 19" stroke="#EB5757" stroke-width="2" />
        <path d="M402 1L420 19" stroke="#EB5757" stroke-width="2" />
        <path d="M412 1L430 19" stroke="#EB5757" stroke-width="2" />
        <path d="M422 1L440 19" stroke="#EB5757" stroke-width="2" />
        <path d="M432 1L450 19" stroke="#EB5757" stroke-width="2" />
        <path d="M442 1L460 19" stroke="#EB5757" stroke-width="2" />
        <path d="M452 1L470 19" stroke="#EB5757" stroke-width="2" />
        <path d="M462 1L480 19" stroke="#EB5757" stroke-width="2" />
        <path d="M472 1L490 19" stroke="#EB5757" stroke-width="2" />
      </svg>
    </section>

    <script src="js/main.js"></script>

    <script>
      function dayDifference(date1, date2) {
        const MILLISECONDS_PER_DAY = 1000 * 60 * 60 * 24;
        var timeDiff = Math.abs(date2.getTime() - date1.getTime());
        var diffDays = Math.ceil(timeDiff / MILLISECONDS_PER_DAY);
        return diffDays;
      }

      function ru_days(num) {
        num = parseInt(num);
        if (num === 0) return "дней";
        if (num === 1) return "день";
        if (num < 5) return "дня";
        if (num < 21) return "дней";

        let last = parseInt(
          num
            .toString()
            .split("")
            .pop()
        );
        if (last === 0) return "дней";
        if (last === 1) return "день";
        if (last < 5) return "дня";
        if (last < 10) return "дней";

        return "дней";
      }

      function calcProgress() {
        let counter = document.querySelector("#counter");
        if (!counter) return;
        let progress = counter.querySelector(".progress__value");
        if (!progress) return;

        let finish = counter.dataset.finish;
        finish = new Date(finish);

        let current = new Date();

        let firstDiff = current.getTime() > finish.getTime() ? finish : current;
        let secondDiff =
          current.getTime() > finish.getTime() ? current : finish;

        let diff =
          current.getTime() > finish.getTime()
            ? 1
            : dayDifference(finish, current);

        let dash = progress.getAttribute("stroke-dashoffset");
        dash = parseFloat(dash);

        let num = counter.querySelector(".num");

        let maxDays = parseInt(counter.dataset.max);
        let realDays = diff <= maxDays ? diff : maxDays;

        let text = document.querySelector(".counter-days");
        if (text) {
          let textDays = ru_days(realDays);
          text.innerHTML = textDays;
        }
        if (num) {
          num.innerHTML = realDays;
        }

        maxDays = maxDays > diff ? maxDays : diff;

        let newDash = (diff * dash) / maxDays;

        progress.setAttribute("stroke-dashoffset", newDash);
      }

      window.addEventListener("load", function() {
        calcProgress();
      });
    </script>
  </body>
</html>
